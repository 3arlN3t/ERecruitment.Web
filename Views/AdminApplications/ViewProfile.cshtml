@model ERecruitment.Web.ViewModels.AdminApplicantProfileViewModel
@{
    ViewData["Title"] = $"Applicant Profile - {Model.FullName}";
    var statusClass = Model.ApplicationStatus switch
    {
        ERecruitment.Web.Models.ApplicationStatus.Submitted => "bg-primary",
        ERecruitment.Web.Models.ApplicationStatus.Interview => "bg-info",
        ERecruitment.Web.Models.ApplicationStatus.Offer => "bg-success",
        ERecruitment.Web.Models.ApplicationStatus.Rejected => "bg-danger",
        ERecruitment.Web.Models.ApplicationStatus.Withdrawn => "bg-secondary",
        _ => "bg-warning"
    };
}

<div class="container-fluid mt-4">
    <div class="row mb-3">
        <div class="col">
            <h2>@Model.FullName</h2>
            <p class="text-muted">@Model.Email</p>
        </div>
        <div class="col-auto">
            <a href="@Url.Action("Edit", new { id = Model.ApplicationId })" class="btn btn-primary">Update Status</a>
            <a href="@Url.Action("Index")" class="btn btn-secondary">Back to List</a>
        </div>
    </div>

    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card">
                <div class="card-body">
                    <h6 class="card-subtitle mb-2 text-muted">Position Applied</h6>
                    <p class="card-text"><strong>@Model.JobTitle</strong></p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card">
                <div class="card-body">
                    <h6 class="card-subtitle mb-2 text-muted">Application Status</h6>
                    <span class="badge @statusClass">@Model.ApplicationStatus</span>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card">
                <div class="card-body">
                    <h6 class="card-subtitle mb-2 text-muted">Submitted</h6>
                    <p class="card-text">@(Model.SubmittedAt?.ToLocalTime().ToString("dd MMM yyyy HH:mm") ?? "Not submitted")</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card">
                <div class="card-body">
                    <h6 class="card-subtitle mb-2 text-muted">Age</h6>
                    <p class="card-text">@(Model.Age?.ToString() ?? "N/A") years</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation Tabs -->
    <ul class="nav nav-tabs" id="profileTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="personal-tab" data-bs-toggle="tab" data-bs-target="#personal" type="button" role="tab">Personal Info</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="qualifications-tab" data-bs-toggle="tab" data-bs-target="#qualifications" type="button" role="tab">Qualifications</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="experience-tab" data-bs-toggle="tab" data-bs-target="#experience" type="button" role="tab">Experience</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="declarations-tab" data-bs-toggle="tab" data-bs-target="#declarations" type="button" role="tab">Declarations</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="documents-tab" data-bs-toggle="tab" data-bs-target="#documents" type="button" role="tab">Documents</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="screening-tab" data-bs-toggle="tab" data-bs-target="#screening" type="button" role="tab">Screening Answers</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="audit-tab" data-bs-toggle="tab" data-bs-target="#audit" type="button" role="tab">Audit Trail</button>
        </li>
    </ul>

    <!-- Tab Content -->
    <div class="tab-content border border-top-0 p-4" id="profileTabsContent">

        <!-- Personal Information Tab -->
        <div class="tab-pane fade show active" id="personal" role="tabpanel">
            <div class="row">
                <div class="col-md-6">
                    <h5>Contact Information</h5>
                    <table class="table table-sm">
                        <tr><th width="40%">Email:</th><td>@Model.ContactEmail</td></tr>
                        <tr><th>Phone:</th><td>@Model.PhoneNumber</td></tr>
                        <tr><th>Address:</th><td>@Model.Location</td></tr>
                        <tr><th>Preferred Language:</th><td>@Model.PreferredLanguage</td></tr>
                    </table>

                    <h5 class="mt-4">Identity</h5>
                    <table class="table table-sm">
                        <tr><th width="40%">Date of Birth:</th><td>@(Model.DateOfBirth?.ToString("dd MMM yyyy") ?? "N/A")</td></tr>
                        <tr><th>Age:</th><td>@(Model.Age?.ToString() ?? "N/A") years</td></tr>
                        <tr><th>SA ID Number:</th><td>@Model.SaIdNumber</td></tr>
                        <tr><th>Passport Number:</th><td>@Model.PassportNumber</td></tr>
                        <tr><th>South African:</th><td>@(Model.IsSouthAfrican ? "Yes" : "No")</td></tr>
                        <tr><th>Nationality:</th><td>@Model.Nationality</td></tr>
                    </table>

                    <h5 class="mt-4">Work Permit</h5>
                    <table class="table table-sm">
                        <tr><th width="40%">Has Work Permit:</th><td>@(Model.HasWorkPermit ? "Yes" : "No")</td></tr>
                        @if (Model.HasWorkPermit)
                        {
                            <tr><th>Details:</th><td>@Model.WorkPermitDetails</td></tr>
                        }
                    </table>
                </div>

                <div class="col-md-6">
                    <h5>Equity Information</h5>
                    <table class="table table-sm">
                        <tr><th width="40%">Consent Given:</th><td>@(Model.EquityConsentGiven ? "Yes" : "No")</td></tr>
                        @if (Model.EquityConsentGiven)
                        {
                            <tr><th>Ethnicity:</th><td>@Model.Ethnicity</td></tr>
                            <tr><th>Gender:</th><td>@Model.Gender</td></tr>
                            <tr><th>Disability Status:</th><td>@Model.DisabilityStatus</td></tr>
                        }
                    </table>

                    <h5 class="mt-4">Disability</h5>
                    <table class="table table-sm">
                        <tr><th width="40%">Has Disability:</th><td>@(Model.HasDisability ? "Yes" : "No")</td></tr>
                        @if (Model.HasDisability)
                        {
                            <tr><th>Details:</th><td>@Model.DisabilityDetails</td></tr>
                        }
                    </table>

                    <h5 class="mt-4">Language Proficiency</h5>
                    @if (Model.Languages.Any())
                    {
                        <table class="table table-sm table-bordered">
                            <thead>
                                <tr>
                                    <th>Language</th>
                                    <th>Speaking</th>
                                    <th>Reading/Writing</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var lang in Model.Languages)
                                {
                                    <tr>
                                        <td>@lang.LanguageName</td>
                                        <td>@lang.SpeakProficiency</td>
                                        <td>@lang.ReadWriteProficiency</td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    }
                    else
                    {
                        <p class="text-muted">No language proficiency information provided.</p>
                    }
                </div>
            </div>
        </div>

        <!-- Qualifications Tab -->
        <div class="tab-pane fade" id="qualifications" role="tabpanel">
            <h5>Educational Qualifications</h5>
            @if (Model.Qualifications.Any())
            {
                <div class="table-responsive">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>Institution</th>
                                <th>Qualification</th>
                                <th>Student Number</th>
                                <th>Year Obtained</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var qual in Model.Qualifications)
                            {
                                <tr>
                                    <td>@qual.InstitutionName</td>
                                    <td>@qual.QualificationName</td>
                                    <td>@qual.StudentNumber</td>
                                    <td>@qual.YearObtained</td>
                                    <td><span class="badge bg-secondary">@qual.Status</span></td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            }
            else
            {
                <p class="text-muted">No qualifications provided.</p>
            }

            <h5 class="mt-4">Professional Registration</h5>
            <table class="table table-sm">
                <tr><th width="30%">Institution:</th><td>@Model.ProfessionalInstitution</td></tr>
                <tr><th>Registration Number:</th><td>@Model.ProfessionalRegistrationNumber</td></tr>
                <tr><th>Registration Date:</th><td>@(Model.ProfessionalRegistrationDate?.ToString("dd MMM yyyy") ?? "N/A")</td></tr>
            </table>
        </div>

        <!-- Experience Tab -->
        <div class="tab-pane fade" id="experience" role="tabpanel">
            <h5>Work Experience</h5>
            @if (Model.WorkExperience.Any())
            {
                <div class="table-responsive">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>Employer</th>
                                <th>Position</th>
                                <th>From</th>
                                <th>To</th>
                                <th>Status</th>
                                <th>Reason for Leaving</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var exp in Model.WorkExperience)
                            {
                                <tr>
                                    <td>@exp.EmployerName</td>
                                    <td>@exp.PositionHeld</td>
                                    <td>@(exp.FromDate?.ToString("MMM yyyy") ?? "N/A")</td>
                                    <td>@(exp.ToDate?.ToString("MMM yyyy") ?? "Present")</td>
                                    <td><span class="badge bg-info">@exp.Status</span></td>
                                    <td>@exp.ReasonForLeaving</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            }
            else
            {
                <p class="text-muted">No work experience provided.</p>
            }

            <h5 class="mt-4">Sector Experience</h5>
            <div class="row">
                <div class="col-md-6">
                    <table class="table table-sm">
                        <tr><th width="50%">Public Sector:</th><td>@(Model.PublicSectorYears?.ToString() ?? "0") years</td></tr>
                        <tr><th>Private Sector:</th><td>@(Model.PrivateSectorYears?.ToString() ?? "0") years</td></tr>
                    </table>
                </div>
            </div>

            <h5 class="mt-4">References</h5>
            @if (Model.References.Any())
            {
                <div class="table-responsive">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Relationship</th>
                                <th>Contact Number</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var reference in Model.References)
                            {
                                <tr>
                                    <td>@reference.Name</td>
                                    <td>@reference.Relationship</td>
                                    <td>@reference.ContactNumber</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            }
            else
            {
                <p class="text-muted">No references provided.</p>
            }
        </div>

        <!-- Declarations Tab -->
        <div class="tab-pane fade" id="declarations" role="tabpanel">
            <h5>Criminal Record & Legal History</h5>
            <div class="accordion" id="declarationsAccordion">
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button @(Model.HasCriminalRecord ? "" : "collapsed")" type="button" data-bs-toggle="collapse" data-bs-target="#criminalRecord">
                            Criminal Record: @(Model.HasCriminalRecord ? "Yes" : "No")
                        </button>
                    </h2>
                    <div id="criminalRecord" class="accordion-collapse collapse @(Model.HasCriminalRecord ? "show" : "")" data-bs-parent="#declarationsAccordion">
                        <div class="accordion-body">
                            @if (Model.HasCriminalRecord)
                            {
                                <strong>Details:</strong> @Model.CriminalRecordDetails
                            }
                            else
                            {
                                <em>No criminal record</em>
                            }
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button @(Model.HasPendingCase ? "" : "collapsed")" type="button" data-bs-toggle="collapse" data-bs-target="#pendingCase">
                            Pending Criminal Case: @(Model.HasPendingCase ? "Yes" : "No")
                        </button>
                    </h2>
                    <div id="pendingCase" class="accordion-collapse collapse @(Model.HasPendingCase ? "show" : "")" data-bs-parent="#declarationsAccordion">
                        <div class="accordion-body">
                            @if (Model.HasPendingCase)
                            {
                                <strong>Details:</strong> @Model.PendingCaseDetails
                            }
                            else
                            {
                                <em>No pending criminal case</em>
                            }
                        </div>
                    </div>
                </div>
            </div>

            <h5 class="mt-4">Employment History</h5>
            <div class="accordion" id="employmentAccordion">
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button @(Model.DismissedForMisconduct ? "" : "collapsed")" type="button" data-bs-toggle="collapse" data-bs-target="#dismissed">
                            Dismissed for Misconduct: @(Model.DismissedForMisconduct ? "Yes" : "No")
                        </button>
                    </h2>
                    <div id="dismissed" class="accordion-collapse collapse @(Model.DismissedForMisconduct ? "show" : "")" data-bs-parent="#employmentAccordion">
                        <div class="accordion-body">
                            @if (Model.DismissedForMisconduct)
                            {
                                <strong>Details:</strong> @Model.DismissedDetails
                            }
                            else
                            {
                                <em>Not dismissed for misconduct</em>
                            }
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button @(Model.PendingDisciplinaryCase ? "" : "collapsed")" type="button" data-bs-toggle="collapse" data-bs-target="#pendingDisciplinary">
                            Pending Disciplinary Case: @(Model.PendingDisciplinaryCase ? "Yes" : "No")
                        </button>
                    </h2>
                    <div id="pendingDisciplinary" class="accordion-collapse collapse @(Model.PendingDisciplinaryCase ? "show" : "")" data-bs-parent="#employmentAccordion">
                        <div class="accordion-body">
                            @if (Model.PendingDisciplinaryCase)
                            {
                                <strong>Details:</strong> @Model.PendingDisciplinaryDetails
                            }
                            else
                            {
                                <em>No pending disciplinary case</em>
                            }
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button @(Model.ResignedPendingDisciplinary ? "" : "collapsed")" type="button" data-bs-toggle="collapse" data-bs-target="#resigned">
                            Resigned Pending Disciplinary: @(Model.ResignedPendingDisciplinary ? "Yes" : "No")
                        </button>
                    </h2>
                    <div id="resigned" class="accordion-collapse collapse @(Model.ResignedPendingDisciplinary ? "show" : "")" data-bs-parent="#employmentAccordion">
                        <div class="accordion-body">
                            @if (Model.ResignedPendingDisciplinary)
                            {
                                <strong>Details:</strong> @Model.ResignedPendingDisciplinaryDetails
                            }
                            else
                            {
                                <em>Did not resign pending disciplinary proceedings</em>
                            }
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button @(Model.DischargedForIllHealth ? "" : "collapsed")" type="button" data-bs-toggle="collapse" data-bs-target="#discharged">
                            Discharged for Ill Health: @(Model.DischargedForIllHealth ? "Yes" : "No")
                        </button>
                    </h2>
                    <div id="discharged" class="accordion-collapse collapse @(Model.DischargedForIllHealth ? "show" : "")" data-bs-parent="#employmentAccordion">
                        <div class="accordion-body">
                            @if (Model.DischargedForIllHealth)
                            {
                                <strong>Details:</strong> @Model.DischargedDetails
                            }
                            else
                            {
                                <em>Not discharged for ill health</em>
                            }
                        </div>
                    </div>
                </div>
            </div>

            <h5 class="mt-4">Business Interests</h5>
            <div class="accordion" id="businessAccordion">
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button @(Model.BusinessWithState ? "" : "collapsed")" type="button" data-bs-toggle="collapse" data-bs-target="#business">
                            Business with State: @(Model.BusinessWithState ? "Yes" : "No")
                        </button>
                    </h2>
                    <div id="business" class="accordion-collapse collapse @(Model.BusinessWithState ? "show" : "")" data-bs-parent="#businessAccordion">
                        <div class="accordion-body">
                            @if (Model.BusinessWithState)
                            {
                                <p><strong>Details:</strong> @Model.BusinessDetails</p>
                                <p><strong>Will Relinquish:</strong> @(Model.WillRelinquishBusiness ? "Yes" : "No")</p>
                                @if (!string.IsNullOrEmpty(Model.WillRelinquishBusinessPlan))
                                {
                                    <p><strong>Relinquishment Plan:</strong> @Model.WillRelinquishBusinessPlan</p>
                                }
                            }
                            else
                            {
                                <em>No business with the state</em>
                            }
                        </div>
                    </div>
                </div>
            </div>

            <h5 class="mt-4">Re-appointment</h5>
            <div class="accordion" id="reappointmentAccordion">
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button @(Model.ReappointmentCondition ? "" : "collapsed")" type="button" data-bs-toggle="collapse" data-bs-target="#reappointment">
                            Re-appointment Condition: @(Model.ReappointmentCondition ? "Yes" : "No")
                        </button>
                    </h2>
                    <div id="reappointment" class="accordion-collapse collapse @(Model.ReappointmentCondition ? "show" : "")" data-bs-parent="#reappointmentAccordion">
                        <div class="accordion-body">
                            @if (Model.ReappointmentCondition)
                            {
                                <p><strong>Department:</strong> @Model.ReappointmentDepartment</p>
                                <p><strong>Details:</strong> @Model.ReappointmentConditionDetails</p>
                            }
                            else
                            {
                                <em>No re-appointment conditions</em>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Documents Tab -->
        <div class="tab-pane fade" id="documents" role="tabpanel">
            <h5>Attached Documents</h5>
            <div class="list-group">
                @if (Model.CvDocument != null)
                {
                    <div class="list-group-item">
                        <div class="d-flex w-100 justify-content-between align-items-center">
                            <div>
                                <h6 class="mb-1">Curriculum Vitae (CV)</h6>
                                <small class="text-muted">@Model.CvDocument.FileName</small>
                                @if (!string.IsNullOrEmpty(Model.CvDocument.ParsedSummary))
                                {
                                    <p class="mb-1 mt-2"><small><strong>Summary:</strong> @Model.CvDocument.ParsedSummary</small></p>
                                }
                            </div>
                            <a href="@Url.Action("DownloadDocument", new { applicationId = Model.ApplicationId, documentType = "cv" })" class="btn btn-sm btn-primary" target="_blank">
                                <i class="bi bi-download"></i> Download
                            </a>
                        </div>
                    </div>
                }

                @if (Model.IdDocument != null)
                {
                    <div class="list-group-item">
                        <div class="d-flex w-100 justify-content-between align-items-center">
                            <div>
                                <h6 class="mb-1">ID Document</h6>
                                <small class="text-muted">@Model.IdDocument.FileName</small>
                                @if (Model.IdDocument.UploadedAtUtc.HasValue)
                                {
                                    <p class="mb-0"><small>Uploaded: @Model.IdDocument.UploadedAtUtc.Value.ToLocalTime().ToString("dd MMM yyyy HH:mm")</small></p>
                                }
                            </div>
                            <a href="@Url.Action("DownloadDocument", new { applicationId = Model.ApplicationId, documentType = "id" })" class="btn btn-sm btn-primary" target="_blank">
                                <i class="bi bi-download"></i> Download
                            </a>
                        </div>
                    </div>
                }

                @if (Model.QualificationDocument != null)
                {
                    <div class="list-group-item">
                        <div class="d-flex w-100 justify-content-between align-items-center">
                            <div>
                                <h6 class="mb-1">Qualification Certificate</h6>
                                <small class="text-muted">@Model.QualificationDocument.FileName</small>
                                @if (Model.QualificationDocument.UploadedAtUtc.HasValue)
                                {
                                    <p class="mb-0"><small>Uploaded: @Model.QualificationDocument.UploadedAtUtc.Value.ToLocalTime().ToString("dd MMM yyyy HH:mm")</small></p>
                                }
                            </div>
                            <a href="@Url.Action("DownloadDocument", new { applicationId = Model.ApplicationId, documentType = "qualification" })" class="btn btn-sm btn-primary" target="_blank">
                                <i class="bi bi-download"></i> Download
                            </a>
                        </div>
                    </div>
                }

                @if (Model.DriversLicenseDocument != null)
                {
                    <div class="list-group-item">
                        <div class="d-flex w-100 justify-content-between align-items-center">
                            <div>
                                <h6 class="mb-1">Driver's License</h6>
                                <small class="text-muted">@Model.DriversLicenseDocument.FileName</small>
                                @if (Model.DriversLicenseDocument.UploadedAtUtc.HasValue)
                                {
                                    <p class="mb-0"><small>Uploaded: @Model.DriversLicenseDocument.UploadedAtUtc.Value.ToLocalTime().ToString("dd MMM yyyy HH:mm")</small></p>
                                }
                            </div>
                            <a href="@Url.Action("DownloadDocument", new { applicationId = Model.ApplicationId, documentType = "drivers" })" class="btn btn-sm btn-primary" target="_blank">
                                <i class="bi bi-download"></i> Download
                            </a>
                        </div>
                    </div>
                }

                @if (Model.AdditionalDocument != null)
                {
                    <div class="list-group-item">
                        <div class="d-flex w-100 justify-content-between align-items-center">
                            <div>
                                <h6 class="mb-1">Additional Document</h6>
                                <small class="text-muted">@Model.AdditionalDocument.FileName</small>
                                @if (Model.AdditionalDocument.UploadedAtUtc.HasValue)
                                {
                                    <p class="mb-0"><small>Uploaded: @Model.AdditionalDocument.UploadedAtUtc.Value.ToLocalTime().ToString("dd MMM yyyy HH:mm")</small></p>
                                }
                            </div>
                            <a href="@Url.Action("DownloadDocument", new { applicationId = Model.ApplicationId, documentType = "additional" })" class="btn btn-sm btn-primary" target="_blank">
                                <i class="bi bi-download"></i> Download
                            </a>
                        </div>
                    </div>
                }

                @if (Model.CvDocument == null && Model.IdDocument == null && Model.QualificationDocument == null && Model.DriversLicenseDocument == null && Model.AdditionalDocument == null)
                {
                    <div class="list-group-item">
                        <p class="text-muted mb-0">No documents attached</p>
                    </div>
                }
            </div>

            @if (Model.DeclarationAccepted)
            {
                <h5 class="mt-4">Declaration</h5>
                <div class="card">
                    <div class="card-body">
                        <p><strong>Declaration Accepted:</strong> Yes</p>
                        <p><strong>Date:</strong> @(Model.DeclarationDate?.ToString("dd MMM yyyy") ?? "N/A")</p>
                        @if (!string.IsNullOrEmpty(Model.SignatureData))
                        {
                            <p><strong>Signature:</strong></p>
                            <img src="@Model.SignatureData" alt="Applicant Signature" class="border" style="max-width: 300px;" />
                        }
                    </div>
                </div>
            }
        </div>

        <!-- Screening Answers Tab -->
        <div class="tab-pane fade" id="screening" role="tabpanel">
            <h5>Screening Questions & Answers</h5>
            @if (Model.ScreeningAnswers.Any())
            {
                @foreach (var answer in Model.ScreeningAnswers.OrderBy(a => a.Order))
                {
                    <div class="card mb-3">
                        <div class="card-header">
                            <strong>Q@(answer.Order + 1):</strong> @answer.Question
                            @if (answer.MeetsRequirement.HasValue)
                            {
                                <span class="badge @(answer.MeetsRequirement.Value ? "bg-success" : "bg-danger") float-end">
                                    @(answer.MeetsRequirement.Value ? "Meets Requirement" : "Does Not Meet Requirement")
                                </span>
                            }
                        </div>
                        <div class="card-body">
                            <p class="mb-0">@answer.Answer</p>
                        </div>
                    </div>
                }
            }
            else
            {
                <p class="text-muted">No screening questions were answered.</p>
            }
        </div>

        <!-- Audit Trail Tab -->
        <div class="tab-pane fade" id="audit" role="tabpanel">
            <h5>Application Audit Trail</h5>
            @if (Model.AuditTrail.Any())
            {
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Date/Time</th>
                                <th>Actor</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var entry in Model.AuditTrail)
                            {
                                <tr>
                                    <td>@entry.TimestampUtc.ToLocalTime().ToString("dd MMM yyyy HH:mm:ss")</td>
                                    <td>@entry.Actor</td>
                                    <td>@entry.Action</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            }
            else
            {
                <p class="text-muted">No audit trail available.</p>
            }
        </div>
    </div>
</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
}
